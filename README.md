# Лабораторная работа: Использование планировщика задач at

## Цели:

Познакомиться с планировщиком задач at и его основными командами.

Научиться настраивать выполнение задач в будущем.

Получить практический опыт в автоматизации задач с использованием at.



## Теоретическая часть

Основные команды:
```
at (время): добавление нового задания.
```
```
atq: просмотр списка запланированных задач.
```
```
atrm [ID]: удаление задания из списка.
```
```
atd: демон, который выполняет задачи, запланированные через at
```

## Конфигурация прав доступа:

Файлы /etc/at.allow и /etc/at.deny определяют, кто может использовать at.

Если файл /etc/at.allow существует, доступ к at разрешён только пользователям из этого файла.

## Практическая часть

Часть 1: 

1. Запустите демон ```atd```:
 
![{6AA06E80-3AC6-4DF3-A1B6-1A1B0E07CFB7}](https://github.com/user-attachments/assets/6f7547af-32ea-4d71-9415-5e76fc637084)

2. Проверьте права на использование ```at```:
Если вашего пользователя нет в файле ```/etc/at.allow```, добавьте его

![{8413ACAC-E751-4AF6-A0C3-F37E70615D8F}](https://github.com/user-attachments/assets/90b348eb-2f1b-4651-904a-621c491718cc)

3. Запланируйте выполнение команды через 2 минуты
 
![{48A6135E-FC13-4FD1-B797-5A02A6902E59}](https://github.com/user-attachments/assets/8443e189-87b8-4d59-9fdf-44d00c3bba73)  ![{4D698400-8530-4526-AA18-8CFBEB786B64}](https://github.com/user-attachments/assets/af0df81c-48da-4a70-91b2-558a7ffb1345)

4. Убедитесь, что задание добавлено:

![{868A186D-6564-4E44-9F09-69D52947CB3A}](https://github.com/user-attachments/assets/8134f987-6574-4ce5-98cd-6af22e10a56a)

5. Дождитесь выполнения задачи:
Через 2 минуты проверьте файл ```~/at_test.log:```

![{7F9640CE-1858-40C0-81A8-0C86599A4A78}](https://github.com/user-attachments/assets/0166216e-2b87-41d3-8508-d1d4751456c8)

6. Удалите задание
Если задание ещё не выполнено, его можно удалить:

![{EB200300-CB39-492E-9A1A-88194F99B63A}](https://github.com/user-attachments/assets/34b791ba-1a15-4cfe-9aea-69f401626601)



Часть 2:
### Задача на выполнение

1. Настройте выполнение команды, которая через 5 минут создаст резервную копию директории ```~/important``` в файл ```~/backup_important.tar.gz.```
Подсказка:

![{BE46FCE5-2F1E-40F4-B9E7-1F12B9B6DDD8}](https://github.com/user-attachments/assets/3ea31bbc-9d2e-4ca2-9b88-a329a5f2511b)

2. Проверьте, что задание выполнено, и файл создан.

3. Удалите директорию ```~/important``` после создания резервной копии.

## Решение
В терминале пишем :
```echo "tar -czf ~/backup_important.tar.gz ~/important && rm -rf ~/important" | at now + 5 minutes```

Объяснение:
• ```echo "..."``` — передает строку команды в at.

• ```tar -czf ~/backup_important.tar.gz ~/important``` — создает архив в формате tar.gz из директории ~/important.

• ```&&``` — гарантирует, что команда удаления выполнится только если создание резервной копии прошло успешно.

• ```rm -rf ~/important``` — удаляет директорию ```~/important```

После того как пройдет 5 минут, проверьте, был ли создан файл резервной копии:

```ls -l ~/backup_important.tar.gz```

Удаление директории

```ls -l ~/important```




Документация:

https://wiki.archlinux.org/title/Autostarting#On_time_events
https://www.gnu.org/manual/manual.html
https://linux.die.net/man/1/at






